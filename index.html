<html>
    <head>
        <title>NateWorks Pong</title>
    </head>
    <body>
        <h1>Nate Works Pong</h1>
        <script>
            var canv = document.createElement("canvas");
            canv.width = 1000;
            canv.height = 500;
            canv.style = "box-shadow: 10px 10px 20px black;";
            document.body.appendChild(canv);
            var c = canv.getContext("2d");

            //CONST
            var BALL_SIZE = 30;
            var bounce = new Audio("bounce.wav");
            //VAR
            var paddleA = {
                x: 10,
                y: 200,
                score: 0
            };
            var paddleB = {
                x: 960,
                y: 200,
                score: 0
            };
            var ball = {
                x: (500-(BALL_SIZE/2)),
                y: (250-(BALL_SIZE/2)),
                dx: 2,
                dy: 2
            };
            //SETUP
            window.addEventListener("load", start);
            function start() {
                window.requestAnimationFrame(mainloop);
            }
            //INPUT
            window.addEventListener("keydown", keyDown);

            function keyDown() {
                if (event.keyCode == 87) {
                    paddleA.y -= 10;
                } else if (event.keyCode == 83) {
                    paddleA.y += 10;
                } else if (event.keyCode == 38) {
                    paddleB.y -= 10;
                } else if (event.keyCode == 40) {
                    paddleB.y += 10;
                }
            }
            //MAIN
            function mainloop() {
                update();
                draw();
                window.requestAnimationFrame(mainloop);
            }
            //COLLIDE
            function sidesAreColliding(Obj1_LEFT, Obj1_RIGHT, Obj2_LEFT, Obj2_RIGHT) {
                if (((Obj1_RIGHT >= Obj2_LEFT) && (Obj1_RIGHT <= Obj2_RIGHT)) || ((Obj1_LEFT >= Obj2_LEFT) && (Obj1_LEFT <= Obj2_RIGHT)) ) {
                    return true;
                } else {
                    return false;
                }
            }
            function objectsCollide(obj1X, obj1Y, obj1W, obj1H, obj2X, obj2Y, obj2W, obj2H) {
                var alongX = sidesAreColliding(obj1X, obj1X+obj1W, obj2X, obj2X+obj2W);
                var alongY = sidesAreColliding(obj1Y, obj1Y+obj1H, obj2Y, obj2Y+obj2H);
                return alongX && alongY;
            }
            //UPDATE
            function update() {
                //move ball
                ball.x += ball.dx;
                ball.y += ball.dy;

                //ball-to-wall-or-paddle collision
                if (ball.x <= 0) {
                    ball.dx *= -1;
                    bounce.play();
                    paddleB.score += 1;
                } else if (ball.x >= 1000-BALL_SIZE) {
                    ball.dx *= -1;
                    bounce.play();
                    paddleA.score += 1;
                }
                if (ball.y <= 0) {
                    ball.dy *= -1;
                    bounce.play();
                } else if (ball.y >= 500-BALL_SIZE) {
                    ball.dy *= -1;
                    bounce.play();
                }
                if (objectsCollide(ball.x, ball.y, BALL_SIZE, BALL_SIZE, paddleA.x, paddleA.y, 30, 100)) {
                    ball.dx *= -1;    
                    bounce.play();
                } else if (objectsCollide(ball.x, ball.y, BALL_SIZE, BALL_SIZE, paddleB.x, paddleB.y, 30, 100)) {
                    ball.dx *= -1;
                    bounce.play();
                }
            }
            //DRAW
            function draw() {
                //bg
                c.fillStyle = "black";
                c.fillRect(0, 0, 1000, 500);

                //paddle A
                c.fillStyle = "white";
                c.fillRect(paddleA.x, paddleA.y, 30, 100);

                //padlleB
                c.fillStyle = "white";
                c.fillRect(paddleB.x, paddleB.y, 30, 100);

                //ball
                c.fillStyle = "white";
                c.fillRect(ball.x, ball.y, BALL_SIZE, BALL_SIZE);

                //score
                c.fillStyle = "white";
                c.font = "48px sans-serif";
                c.fillText(paddleA.score, 10, 48);
                if (paddleB.score.toString().length == 1) {
                    c.fillText(paddleB.score, 1000-34, 48);
                } else if (paddleB.score.toString().length == 2) {
                    c.fillText(paddleB.score, (1000-(34)*2), 48);
                } else if (paddleB.score.toString().length == 3) {
                    c.fillText(paddleB.score, (1000-(34*3)), 48);
                }
            }
            
        </script>
    </body>
</html>